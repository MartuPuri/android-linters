import android.app.Activity;
import android.os.Bundle;

import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import java.util.HashSet;

public class RestoreStateLocallyAndThenInAField extends Activity {

	public static final String PENDING_ATTACHMENTS = "PENDING_ATTACHMENTS";
	public static final String QUESTION_MESSAGE_HISTORY = "QuestionHistoryMessages";
	public static final String ANSWER = "ANSWER";

	private Map<String, Long> pendingItems;
	private Set<Long> questionMessageHistory;
	private Map<String, Long> answers;

	@Override
	protected void onCreate(final Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);

		if (savedInstanceState.containsKey(QUESTION_MESSAGE_HISTORY)) {
			questionMessageHistory =
					(Set<Long>) savedInstanceState.getSerializable(QUESTION_MESSAGE_HISTORY);
		}

		if (savedInstanceState.containsKey(PENDING_ATTACHMENTS)) {
			final Map<String, Long> savedPendingItems =
					(Map<String, Long>) savedInstanceState.getSerializable(PENDING_ATTACHMENTS);

			if (savedPendingItems != null && !savedPendingItems.isEmpty()) {
				for (final Map.Entry<String, Long> entry : savedPendingItems.entrySet()) {
					for (final long question : questionMessageHistory) {
						if (entry.getValue() == question) {
							getItem(entry.getKey(), question);
						}
					}
				}
				savedPendingItems.clear();
			}
			pendingItems = savedPendingItems;
		}

		if (savedInstanceState.containsKey(ANSWER)) {
			answers = (Map<String, Long>) savedInstanceState.getSerializable(ANSWER);
		}
	}

	private void getItem(final String key, final Long value) {
	}

	@Override
	public void onSaveInstanceState(final Bundle outState) {
		outState.putSerializable(PENDING_ATTACHMENTS, (HashMap<String, Long>) pendingItems);
		outState.putSerializable(QUESTION_MESSAGE_HISTORY, (HashSet<Long>) questionMessageHistory);
		outState.putSerializable(ANSWER, (HashMap<String, Long>) answers);
		super.onSaveInstanceState(outState);
	}
}